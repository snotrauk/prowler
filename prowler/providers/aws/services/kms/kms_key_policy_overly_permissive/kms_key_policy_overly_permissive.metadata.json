{
  "Provider": "aws",
  "CheckID": "kms_key_policy_overly_permissive",
  "CheckTitle": "Overly Permissive KMS Key Policies",
  "CheckType": [
    "Data Protection"
  ],
  "ServiceName": "kms",
  "SubServiceName": "",
  "ResourceIdTemplate": "arn:partition:kms:region:account-id:key/resource-id",
  "Severity": "medium",
  "ResourceType": "AwsKmsKey",
  "Description": "KMS key policies are overly permissive, granting broader access than required, which could inadvertently allow unauthorized entities or roles to decrypt sensitive data in your AWS environment. An overly permissive key policy typically arises when using wildcard actions, overly broad resource definitions, or grants to principals that do not strictly require access (typically all principals in an account), increasing the chance of accidental or unauthorized access to encrypted data.",
  "Risk": "KMS key policies are overly permissive, granting broader access than required, which could inadvertently allow unauthorized entities or roles to decrypt sensitive data in your AWS environment. An overly permissive key policy typically arises when using wildcard actions, overly broad resource definitions, or grants to principals that do not strictly require access (typically all principals in an account), increasing the chance of accidental or unauthorized access to encrypted data.",
  "RelatedUrl": "",
  "Remediation": {
    "Code": {
      "CLI": "",
      "NativeIaC": "",
      "Other": "",
      "Terraform": ""
    },
    "Recommendation": {
      "Text": "Review and update the KMS key policy following the principle of least privilege by explicitly defining only the required AWS principals and actions (such as \"kms:Encrypt\", \"kms:Decrypt\", or \"kms:GenerateDataKey\"). Regular auditing and continuous monitoring of KMS key usage through AWS CloudTrail and IAM Access Analyzer are strongly recommended to mitigate potential security risks and align with best security practices.\nWhere appropriate use the following conditional contexts following the principal of least privilege to effectively limit the scope of KMS Key policies and prevent unintended access opportunities:\n- aws:SourceArn\n- aws:SourceAccount\n- aws:SourceOrgID\n- aws:SourceOrgPaths\nNOTE: IF you grant permission to administer the key to a single principal in the Key Policy then delete that principal, the key becomes unmanageable and you must contact AWS Support to regain access to the KMS key.",
      "Url": ""
    }
  },
  "Categories": [
    "encryption"
  ],
  "DependsOn": [],
  "RelatedTo": [],
  "Notes": ""
}
